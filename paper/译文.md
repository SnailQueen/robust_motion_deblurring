# 两相核估计用以鲁棒的运动去模糊

Li Xu and Jiaya Jia
Department of Computer Science and Engineering The Chinese University of Hong Kong {xuli,leojia}@cse.cuhk.edu.hk

#### 简介  

我们讨论了一些新的运动去模糊问题，这些问题对于核估计和非盲去卷积是非常重要的。 我们发现强边缘并不总是有利于核估计，而是在某些情况下降低了效果。 这一发现产生了一个新的度量标准，用于测量运动去模糊中图像边缘的有用性，以及梯度选择过程，以减轻其可能的不利影响。 我们还提出了一种基于空间先验和迭代支持检测（ISD）内核改进的高效，高质量的内核估计方法，避免了内核元素的硬阈值强制实施稀疏性。 我们采用TV-1反卷积模型，通过新的变量替换方案求解，可以有效地抑制噪声。

## 1. 介绍

由于在问题规范化，正则化和优化中涉及许多挑战，因此在计算机视觉和图形界中激烈讨论了运动去模糊。最近取得了显着进展[1-6]。由相机抖动引起的模糊处理通常被建模为与模糊点扩展函数（也称为内核）卷积的潜像。

最近的单图像方法的成功部分源于使用各种稀疏先验，用于潜像或运动模糊核[1,3,6]。结果发现，如果没有这些约束，迭代内核估计很容易陷入局部最小值，并可能导致密集内核和恢复图像中的许多视觉伪像。然而，通过先验稀疏性来最小化非凸能量函数通常是昂贵的。

另一组方法寻求高效率并且采用明确检测显着图像结构的方法。他们使用高斯核先验[4,5,7]而不是稀疏核。这些方法大大缩短了计算时间;但高斯先验有时会在嘈杂或密集的内核估计中发出，需要通过类似阈值的操作进行后处理。

尽管存在效率和准确性问题，但尚未知道的另一个关键运动去模糊问题是图像结构如何影响核估计。我们有趣的发现是突出的边缘并不总是有助于内核的改进，而是在一些常见的情况下大大增加了估计的模糊性。我们将分析这个问题并提出一种自动梯度选择算法来排除有害结构。

 我们的方法也做了其他一些贡献。 1）首先，我们提出了一种新颖的两阶段核估计算法，将计算昂贵的非凸优化与快速内核初始化分离，从而产生高效且鲁棒的核估计过程。 2）我们在快速潜像恢复中保留锐边之前引入新的空间。 3）在内核改进阶段，我们采用迭代支持检测（ISD）算法，这是一种通过迭代支持检测的强大数值方案，自适应地实施稀疏约束并适当保留大值元素。在该步骤中实现类似软阈值的效果。 4）最后，为了恢复潜像，我们采用了对噪声具有鲁棒性的TV-1（这里有缺失，部分符号找不到，还需要参考原文）目标函数，并开发了基于半二次分裂的高效求解器。

我们将我们的方法应用于具有挑战性的示例，其中许多图像由于相机抖动而具有非常大的PSF（宽度或高度跨越多达100个像素）而模糊。 我们的“强大的deblurring”项目网站是在线1，其中包括动作去模糊可执行文件和图像数据。

## 1.1 相关工作

可以将移位不变运动模糊建模为具有PSF的图像卷积。我们简要回顾盲目和非盲解卷积方法。

盲目反卷积。早期关于盲图像去卷积的工作主要集中在估计小尺寸模糊核上。例如，You和Kaveh [8]提出了一种估计小高斯核的变分框架。 Chan和Wong [9]将Total Variation正则化器应用于内核和图像。另一组方法[10-12]没有计算模糊内核，而是研究了反向过程的逆转。最近，在从单个图像估计复杂运动模糊PSF方面取得了令人瞩目的进展[1,3,6]。成功的部分原因是使用了sparsepriors和多尺度框架.Fergus等。 [1]使用零均值高斯混合来预测重尾自然图像。采用变分贝叶斯框架。 Shan等人。 [3]也利用了潜在图像和模糊内核的稀疏先验。通过交替最小化方案实现去模糊。蔡等人。 [6]引入了一个framelet和curvelet系统来获得内核和图像的稀疏表示。莱文等人。 [13]表明，涉及估计图像和内核的常见MAP方法可能会失败，因为它们有利于微不足道的解决方案。边缘重新加权等特别注意可能是补救措施。值得注意的是，使用sparsepriors通常会产生非凸的目标函数，从而阻碍了效率的优化。

另一组方法[4,5,7]不使用稀疏先验，但是他们在PSF估计中使用了明确的边缘预测步骤。 具体而言，Joshi等人。 [4]通过首先定位阶梯边缘然后将局部强度极值传播到边缘来预测锐边。 该方法用于处理具有多尺度方案的复杂PSF [7]。 Cho和Lee [5]采用双边滤波和冲击滤波来预测锐边。 这些方法强加了简单的高斯先验，有助于构建快速求解器。 这些先行者无论如何都无法获得PSF和图像结构的特征，偶尔会使估计噪声和密集。

非盲去卷积。给定已知的模糊PSF，恢复不模糊图像的过程称为非盲去卷积。像Richardson-Lucy（RL）或Weiner过滤这样的早期工作被称为对噪声敏感。袁等人。 [14]提出了一种基于边缘保持双边Richardson-Lucy（BRL）方法的渐进式多尺度改进方案。 Total Variationregularizer（也称为Laplacian先前）[9]，重尾自然图像先验[1,3]和Hyper-Laplacian先验[15-18]也被广泛研究。为了抑制噪音，Bar等人。 [19]使用α1灵性术语和Mumford-Shah正则化器来抑制脉冲噪声。乔希等人。 [20]在抑制噪音之前加入了局部双色。这些方法使用迭代重加权最小二乘法来解决非线性优化问题，这不可避免地涉及强化计算。本文开发了基于半二次分裂的快速TV-1反褶积方法[16,18]，以有效地抑制异常值并保留结构。 

## 2. 两阶段稀疏核估计

按照惯例，模糊过程被建模为:
                    B=I⊗k +ε, 

其中I是潜像，k是模糊核，ε是图像噪声，⊗表示卷积，B是观察到的图像。在本节中，我们介绍了用于PSF估计的两相法。 第一阶段的目的是有效地计算内核的粗略转换而不强制执行这种冗余。在第二阶段，虽然采用非凸优化，但初始核估计从第一阶段传播，因此不需要有意义的计算来产生最终结果。

### 2.1 内核初始化

在第一步中，我们在多尺度设置中估计模糊内核。 当我们使用存在封闭形式解决方案的高斯先验时，可以产生高效率。 该算法在Alg.1.中描绘有三个主要步骤 - 即锐边构造，核估计和粗略图像恢复。

首先，像其他运动去模糊方法一样，我们过滤图像并预测显着边缘以指导内核初始化。 我们使用高斯滤波来预处理图像，然后解决以下冲击滤波PDE问题[10]以构建重要的阶梯边缘：
                ∂I/∂t =−sign(ΔI)∇I, I0 = Gσ ⊗Iinput, (1)

(很不幸，公式我懒得打)

***
**算法 1. 内核初始化**
***
**INPUT:** 模糊图像B 和一个全为零的内核(尺寸 h x h)
构建具有级别索引{1,2，...，n}的图像金字塔。
(一段matlab风格代码，或者说伪代码？这段建议看原文)

``` 

for l = 1 ton do
    计算所有像素的梯度信度r（公式（2））。
     for i = 1 tom （m是迭代次数)do
     (a) 为了基于信度r的内核估计选择边缘∇Is  (公式 (4)).
     (b) 用高斯先验估计内核 (公式 (6)).
     (c) 用空间先验（方程（8））估计潜像Il，并更新τs←τs/ 1.1，τr←τr/ 1.1. 
     end for
     Upscale image Il+1 ← Il ↑. 
end for
```

输出：核估计k0和锐边梯度图∇Is

.感觉这就有点问题。